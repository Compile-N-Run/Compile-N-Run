---
title: ".NET StreamReader and StreamWriter"
description: "Learn how to efficiently read from and write to text files in .NET applications using StreamReader and StreamWriter classes"

---

# .NET StreamReader and StreamWriter

When working with text files in .NET applications, two classes stand out as essential tools: `StreamReader` and `StreamWriter`. These classes provide efficient ways to read from and write to text files, making them fundamental components in a developer's toolkit for file handling operations.

## Understanding Streams in .NET

Before diving into `StreamReader` and `StreamWriter`, it's important to understand the concept of streams in .NET.

A stream is an abstraction that represents a sequence of bytes. Streams provide a standardized way to handle the transfer of data between different sources and destinations, such as files, network connections, or memory. They allow you to read from and write to these sources without needing to understand the underlying details of how the data is physically stored or transferred.

## StreamReader: Reading Text Files

The `StreamReader` class is designed specifically for reading characters from a stream. It's optimized for text files and provides methods to read text one character, one line, or the entire file at a time.

### Creating a StreamReader

To start working with `StreamReader`, you need to create an instance of the class by providing the path to the file you want to read:

```csharp
using System;
using System.IO;

public class StreamReaderExample
{
    public static void Main()
    {
        string filePath = "example.txt";
        
        try
        {
            // Create an instance of StreamReader to read from a file
            using (StreamReader reader = new StreamReader(filePath))
            {
                // Use the reader here
            }
        }
        catch (FileNotFoundException)
        {
            Console.WriteLine($"The file {filePath} was not found.");
        }
        catch (IOException ex)
        {
            Console.WriteLine($"An error occurred while reading the file: {ex.Message}");
        }
    }
}
```

Notice the `using` statement which ensures that the `StreamReader` is properly disposed of after use, even if an exception occurs. This is important because `StreamReader` works with system resources that need to be released promptly.

### Reading Methods

`StreamReader` provides several methods to read from a text file:

#### Reading Characters

```csharp
// Read a single character
int charCode = reader.Read(); // Returns -1 at the end of the file
if (charCode != -1)
{
    char character = (char)charCode;
    Console.WriteLine($"Read character: {character}");
}
```

#### Reading Lines

```csharp
// Read one line at a time
string line;
while ((line = reader.ReadLine()) != null)
{
    Console.WriteLine($"Line: {line}");
}
```

#### Reading the Entire File

```csharp
// Read the entire file into a string
string content = reader.ReadToEnd();
Console.WriteLine("File content:");
Console.WriteLine(content);
```

### Complete StreamReader Example

Here's a complete example that demonstrates reading a text file line by line:

```csharp
using System;
using System.IO;

public class StreamReaderDemo
{
    public static void Main()
    {
        string filePath = "sample.txt";
        
        // Let's create a sample file first
        using (StreamWriter writer = new StreamWriter(filePath))
        {
            writer.WriteLine("This is line 1");
            writer.WriteLine("This is line 2");
            writer.WriteLine("This is line 3");
        }

        // Now let's read from it
        using (StreamReader reader = new StreamReader(filePath))
        {
            Console.WriteLine("Reading file content line by line:");
            string line;
            int lineNumber = 1;
            
            while ((line = reader.ReadLine()) != null)
            {
                Console.WriteLine($"Line {lineNumber++}: {line}");
            }
        }
    }
}
```

**Output:**
```
Reading file content line by line:
Line 1: This is line 1
Line 2: This is line 2
Line 3: This is line 3
```

## StreamWriter: Writing to Text Files

The `StreamWriter` class is used for writing characters to a stream. Like `StreamReader`, it's optimized for text rather than binary data.

### Creating a StreamWriter

You can create a `StreamWriter` instance by providing the path to the file you want to write to:

```csharp
using System;
using System.IO;

public class StreamWriterExample
{
    public static void Main()
    {
        string filePath = "output.txt";
        
        try
        {
            // Create an instance of StreamWriter to write to a file
            // The second parameter (true) indicates that we want to append to the file
            // If false (default), it will overwrite any existing content
            using (StreamWriter writer = new StreamWriter(filePath, false))
            {
                // Use the writer here
            }
        }
        catch (IOException ex)
        {
            Console.WriteLine($"An error occurred while writing to the file: {ex.Message}");
        }
    }
}
```

### Writing Methods

`StreamWriter` provides several methods to write to a text file:

#### Writing Characters and Strings

```csharp
// Write a single character
writer.Write('A');

// Write a string without a new line
writer.Write("Hello, ");

// Write a string with a new line
writer.WriteLine("World!");

// Write formatted string
int age = 25;
writer.WriteLine($"I am {age} years old.");
```

### Flushing and Closing

For efficiency, `StreamWriter` buffers data before actually writing it to the file. When you want to ensure that all data is written immediately, you can use the `Flush()` method:

```csharp
writer.Flush();
```

However, when you use the `using` statement, the writer is automatically flushed and closed when it goes out of scope.

### Complete StreamWriter Example

Here's a complete example showing how to write multiple lines to a text file:

```csharp
using System;
using System.IO;

public class StreamWriterDemo
{
    public static void Main()
    {
        string filePath = "todo.txt";
        
        try
        {
            // Create a new file and write some lines to it
            using (StreamWriter writer = new StreamWriter(filePath))
            {
                Console.WriteLine("Writing to todo.txt...");
                writer.WriteLine("TO-DO LIST:");
                writer.WriteLine("1. Learn StreamWriter");
                writer.WriteLine("2. Practice file handling");
                writer.WriteLine("3. Build a file processing application");
                
                // Adding a formatted date
                writer.WriteLine($"Created on: {DateTime.Now.ToShortDateString()}");
            }
            
            // Read and display what we just wrote
            Console.WriteLine("\nFile content:");
            using (StreamReader reader = new StreamReader(filePath))
            {
                Console.WriteLine(reader.ReadToEnd());
            }
        }
        catch (IOException ex)
        {
            Console.WriteLine($"An error occurred: {ex.Message}");
        }
    }
}
```

**Output:**
```
Writing to todo.txt...

File content:
TO-DO LIST:
1. Learn StreamWriter
2. Practice file handling
3. Build a file processing application
Created on: 5/15/2023
```

## Practical Example: Log File Analyzer

Let's create a more practical example where we use both `StreamReader` and `StreamWriter` to create a simple log file analyzer:

```csharp
using System;
using System.IO;
using System.Collections.Generic;

public class LogAnalyzer
{
    public static void Main()
    {
        string logFilePath = "application.log";
        string reportFilePath = "error_report.txt";
        
        // Create a sample log file
        CreateSampleLogFile(logFilePath);
        
        // Analyze the log file for errors
        AnalyzeLogFile(logFilePath, reportFilePath);
        
        // Display the report
        DisplayReport(reportFilePath);
    }
    
    static void CreateSampleLogFile(string path)
    {
        using (StreamWriter writer = new StreamWriter(path))
        {
            writer.WriteLine("[INFO] 2023-05-15 10:15:32 - Application started");
            writer.WriteLine("[INFO] 2023-05-15 10:15:33 - Loading configuration");
            writer.WriteLine("[ERROR] 2023-05-15 10:15:34 - Failed to connect to database");
            writer.WriteLine("[INFO] 2023-05-15 10:15:35 - Retrying connection...");
            writer.WriteLine("[INFO] 2023-05-15 10:15:40 - Connected to database");
            writer.WriteLine("[WARNING] 2023-05-15 10:16:10 - Slow query detected");
            writer.WriteLine("[ERROR] 2023-05-15 10:16:40 - Timeout executing query");
            writer.WriteLine("[INFO] 2023-05-15 10:17:00 - User logged in: john_doe");
            writer.WriteLine("[ERROR] 2023-05-15 10:18:30 - Permission denied for resource");
            writer.WriteLine("[INFO] 2023-05-15 10:20:00 - Application shutdown initiated");
        }
        
        Console.WriteLine($"Sample log file created: {path}");
    }
    
    static void AnalyzeLogFile(string logPath, string reportPath)
    {
        try
        {
            List<string> errors = new List<string>();
            
            // Read the log file and extract errors
            using (StreamReader reader = new StreamReader(logPath))
            {
                string line;
                int lineNumber = 1;
                
                while ((line = reader.ReadLine()) != null)
                {
                    if (line.Contains("[ERROR]"))
                    {
                        errors.Add($"Line {lineNumber}: {line}");
                    }
                    lineNumber++;
                }
            }
            
            // Write the error report
            using (StreamWriter writer = new StreamWriter(reportPath))
            {
                writer.WriteLine("ERROR REPORT");
                writer.WriteLine($"Generated on: {DateTime.Now}");
                writer.WriteLine($"Log file analyzed: {logPath}");
                writer.WriteLine($"Total errors found: {errors.Count}");
                writer.WriteLine(new string('-', 50));
                
                foreach (string error in errors)
                {
                    writer.WriteLine(error);
                }
            }
            
            Console.WriteLine($"Analysis complete. Report generated: {reportPath}");
        }
        catch (IOException ex)
        {
            Console.WriteLine($"Error analyzing log file: {ex.Message}");
        }
    }
    
    static void DisplayReport(string reportPath)
    {
        Console.WriteLine("\nERROR REPORT CONTENT:");
        Console.WriteLine(new string('=', 50));
        
        using (StreamReader reader = new StreamReader(reportPath))
        {
            Console.WriteLine(reader.ReadToEnd());
        }
    }
}
```

**Output:**
```
Sample log file created: application.log
Analysis complete. Report generated: error_report.txt

ERROR REPORT CONTENT:
==================================================
ERROR REPORT
Generated on: 5/15/2023 11:30:22 AM
Log file analyzed: application.log
Total errors found: 3
--------------------------------------------------
Line 3: [ERROR] 2023-05-15 10:15:34 - Failed to connect to database
Line 7: [ERROR] 2023-05-15 10:16:40 - Timeout executing query
Line 9: [ERROR] 2023-05-15 10:18:30 - Permission denied for resource
```

This example demonstrates a real-world application of `StreamReader` and `StreamWriter` for processing log files, which is a common task in many applications.

## Working with File Encoding

By default, `StreamReader` and `StreamWriter` use the system's default encoding (usually UTF-8). However, you can specify a different encoding if needed:

```csharp
using System;
using System.IO;
using System.Text;

public class EncodingExample
{
    public static void Main()
    {
        string filePath = "encoded.txt";
        
        // Write using UTF-16 encoding
        using (StreamWriter writer = new StreamWriter(filePath, false, Encoding.Unicode))
        {
            writer.WriteLine("This text is encoded in UTF-16");
        }
        
        // Read using UTF-16 encoding
        using (StreamReader reader = new StreamReader(filePath, Encoding.Unicode))
        {
            string content = reader.ReadToEnd();
            Console.WriteLine($"Content read with UTF-16 encoding: {content}");
        }
        
        // Try to read with the wrong encoding
        using (StreamReader reader = new StreamReader(filePath, Encoding.ASCII))
        {
            string content = reader.ReadToEnd();
            Console.WriteLine($"Content read with incorrect encoding (ASCII): {content}");
        }
    }
}
```

This example demonstrates how using the correct encoding is important when working with text files, especially those that contain non-ASCII characters.

## Best Practices

When working with `StreamReader` and `StreamWriter`, consider these best practices:

1. **Always use `using` statements** to ensure proper resource disposal
2. **Handle exceptions** that may occur during file operations
3. **Check if a file exists** before attempting to read from it
4. **Consider file locking** and concurrent access issues in multi-user scenarios
5. **Choose the appropriate encoding** for your specific needs
6. **Buffer size considerations** for very large files
7. **Use `async`/`await`** for non-blocking file operations in responsive applications

## Summary

`StreamReader` and `StreamWriter` are powerful classes in the .NET framework that make working with text files straightforward and efficient:

- `StreamReader` provides methods to read characters, lines, or entire text files
- `StreamWriter` offers ways to write characters, strings, and formatted text to files
- Both classes handle text encoding, buffering, and resource management
- They're optimized for text files rather than binary data
- The `using` statement ensures proper disposal of resources
- Exception handling is important for robust file operations

By understanding and utilizing these classes, you can efficiently handle text-based file operations in your .NET applications.

## Exercises

To reinforce your understanding of `StreamReader` and `StreamWriter`, try these exercises:

1. Create a program that reads a text file and counts the number of words, lines, and characters.
2. Build a simple note-taking application that can save and load notes using `StreamWriter` and `StreamReader`.
3. Create a CSV file parser that reads data from a CSV file and converts it to a collection of objects.
4. Implement a configuration file reader that loads application settings from a text file.
5. Create a log rotation utility that archives older log entries and maintains the current log file size.

## Additional Resources

- [Microsoft Documentation: StreamReader Class](https://docs.microsoft.com/en-us/dotnet/api/system.io.streamreader)
- [Microsoft Documentation: StreamWriter Class](https://docs.microsoft.com/en-us/dotnet/api/system.io.streamwriter)
- [.NET File I/O Documentation](https://docs.microsoft.com/en-us/dotnet/standard/io/)
- [Character Encoding in .NET](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-encoding)