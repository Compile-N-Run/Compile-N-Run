---
title: Next.js Configuration
description: Learn how to customize and configure your Next.js application using configuration files and options to optimize your development workflow.

---

# Next.js Configuration

Configuration is a crucial part of any web development framework, and Next.js provides flexible ways to customize your application behavior. In this guide, you'll learn how to effectively configure your Next.js application to meet specific requirements and optimize performance.

## Introduction to Next.js Configuration

Next.js is designed with a "zero-config" philosophy, meaning it works great out of the box. However, as your application grows, you'll likely need to customize various aspects of your project. Next.js provides several configuration options that allow you to tailor the framework to your needs without losing the benefits of its built-in optimizations.

The primary configuration file in Next.js is `next.config.js`, which is located in the root directory of your project. This JavaScript file exports a configuration object that Next.js uses to customize the build process, server behavior, and other aspects of your application.

## Basic Configuration Setup

### Creating a next.config.js File

Let's start by creating a basic `next.config.js` file:

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  // Add your configurations here
}

module.exports = nextConfig
```

This simple configuration enables React's Strict Mode, which helps identify potential problems in your application during development.

### Configuration Options Format

Next.js configuration can be exported in two ways:

1. **Object format** (as shown above)
2. **Function format** that returns an object:

```javascript
/** @type {import('next').NextConfig} */
module.exports = (phase, { defaultConfig }) => {
  return {
    reactStrictMode: true,
    // Other configurations
  }
}
```

The function format is useful when you need to conditionally set configuration values based on the build phase or environment.

## Essential Configuration Options

### Environment Variables

Next.js makes it easy to work with environment variables. You can create a `.env.local` file in your project root:

```
API_KEY=your_api_key_here
DATABASE_URL=your_database_url
```

To expose environment variables to the browser, prefix them with `NEXT_PUBLIC_`:

```
NEXT_PUBLIC_ANALYTICS_ID=abcdefg
```

You can then access them in your code:

```javascript
// Server-side (accessible only on server)
console.log(process.env.API_KEY);

// Client-side (exposed to browser via NEXT_PUBLIC prefix)
console.log(process.env.NEXT_PUBLIC_ANALYTICS_ID);
```

### Redirects and Rewrites

Next.js allows you to define redirect rules in your configuration:

```javascript
module.exports = {
  async redirects() {
    return [
      {
        source: '/old-blog/:slug',
        destination: '/blog/:slug',
        permanent: true, // 308 status code
      },
    ]
  },
}
```

Similarly, you can set up rewrites, which keep the URL the same but change the page that's rendered:

```javascript
module.exports = {
  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: 'https://api.example.com/:path*',
      },
    ]
  },
}
```

### Custom Webpack Configuration

You can extend the default webpack configuration to add custom loaders or plugins:

```javascript
module.exports = {
  webpack: (config, { buildId, dev, isServer, defaultLoaders, webpack }) => {
    // Add your custom webpack configurations
    config.plugins.push(new webpack.IgnorePlugin({
      resourceRegExp: /^\.\/locale$/,
      contextRegExp: /moment$/,
    }))
    
    return config
  },
}
```

This example adds the `IgnorePlugin` to reduce the size of the `moment.js` library by excluding unnecessary locale files.

## Performance Optimizations

### Image Optimization

Next.js includes an Image Component and automatic image optimization. You can configure this feature in your `next.config.js`:

```javascript
module.exports = {
  images: {
    domains: ['example.com', 'another-domain.com'],
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
  },
}
```

This configuration:
- Allows images from specific domains
- Specifies which image formats to generate
- Sets the device and image sizes for responsive images

### International Routing (i18n)

For multilingual applications, Next.js offers built-in internationalization support:

```javascript
module.exports = {
  i18n: {
    // List of locales supported
    locales: ['en-US', 'fr', 'es', 'de'],
    // Default locale
    defaultLocale: 'en-US',
    // Domain-specific locales
    domains: [
      {
        domain: 'example.com',
        defaultLocale: 'en-US',
      },
      {
        domain: 'example.fr',
        defaultLocale: 'fr',
      },
    ],
  },
}
```

## Advanced Configuration

### HTTP Headers Configuration

You can set custom HTTP headers for your Next.js application:

```javascript
module.exports = {
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          {
            key: 'X-Frame-Options',
            value: 'DENY',
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff',
          },
          {
            key: 'Content-Security-Policy',
            value: "default-src 'self'",
          },
        ],
      },
    ]
  },
}
```

This example adds security-related HTTP headers to all routes in your application.

### Module Transpilation

If you need to include and transpile node_modules, you can use the `transpilePackages` option:

```javascript
module.exports = {
  transpilePackages: ['my-library', 'another-library'],
}
```

This is particularly useful when working with packages that use modern JavaScript features but aren't pre-compiled.

## Real-World Configuration Example

Here's a comprehensive configuration example that combines several common settings:

```javascript
/** @type {import('next').NextConfig} */
const { PHASE_DEVELOPMENT_SERVER } = require('next/constants');

module.exports = (phase, { defaultConfig }) => {
  const isDev = phase === PHASE_DEVELOPMENT_SERVER;
  
  return {
    reactStrictMode: true,
    swcMinify: true,  // Use SWC for minification
    
    // Environment-specific settings
    env: {
      API_URL: isDev
        ? 'http://localhost:3000/api'
        : 'https://production-api.example.com',
      FEATURE_FLAGS: {
        NEW_DASHBOARD: isDev || process.env.ENABLE_NEW_DASHBOARD === 'true',
      },
    },
    
    // Image optimization
    images: {
      domains: ['images.example.com', 'cdn.another-domain.com'],
      formats: ['image/avif', 'image/webp'],
    },
    
    // Routing configurations
    async redirects() {
      return [
        {
          source: '/old-page',
          destination: '/new-page',
          permanent: true,
        },
      ];
    },
    
    async rewrites() {
      return {
        beforeFiles: [
          {
            source: '/products/:id',
            destination: '/items/:id',
          },
        ],
        afterFiles: [
          {
            source: '/api/:path*',
            destination: isDev
              ? 'http://localhost:8000/api/:path*'
              : 'https://api.example.com/:path*',
          },
        ],
      };
    },
    
    // Webpack customization
    webpack: (config) => {
      // Custom webpack rules
      config.module.rules.push({
        test: /\.svg$/,
        use: ['@svgr/webpack'],
      });
      
      return config;
    },
  };
};
```

This configuration:
1. Uses different API URLs for development and production
2. Enables feature flags conditionally
3. Configures image domains and formats
4. Sets up redirects and rewrites
5. Customizes webpack to handle SVG files with `@svgr/webpack`

## Summary

Next.js configuration gives you powerful control over your application behavior, from basic settings to advanced customizations. Through the `next.config.js` file, you can:

- Customize build-time behavior
- Set environment variables
- Configure routing with redirects and rewrites
- Optimize images
- Extend webpack configuration
- Set up internationalization
- Add security headers
- And much more

As your application grows, you can incrementally add configuration options to meet your specific requirements while maintaining Next.js's performance benefits.

## Additional Resources

To learn more about Next.js configuration, check out these resources:

- [Official Next.js Configuration Documentation](https://nextjs.org/docs/api-reference/next.config.js/introduction)
- [Next.js GitHub Repository](https://github.com/vercel/next.js)
- [Vercel Platform Documentation](https://vercel.com/docs)

## Exercises

1. Create a `next.config.js` file that redirects users from `/products/:id` to `/shop/items/:id`.
2. Add configuration to optimize images from an external domain like `cloudinary.com`.
3. Set up environment variables for different environments (development, staging, and production).
4. Configure your Next.js application to support multiple languages with the built-in i18n support.
5. Extend the webpack configuration to handle a custom file type or optimize bundle size.

By mastering Next.js configuration, you can fine-tune your application for optimal performance, improved developer experience, and enhanced functionality.