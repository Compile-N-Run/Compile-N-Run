---
title: Kong Security
description: Learn how to secure your APIs with Kong Gateway security plugins and best practices

---

# Kong Security

## Introduction

Kong Gateway is a popular open-source API gateway that acts as a reverse proxy, routing client requests to your backend services. Security is a critical aspect of any API infrastructure, and Kong provides robust security capabilities through its plugin ecosystem.

In this guide, we'll explore Kong's security plugins and best practices to help you protect your APIs from unauthorized access and potential threats. Whether you're building a small application or an enterprise microservices architecture, implementing proper security measures with Kong is essential.

## Why API Security Matters

Before diving into Kong's security features, let's understand why API security is crucial:

1. **Data Protection**: APIs often expose sensitive data that needs protection from unauthorized access
2. **Prevent Abuse**: Without proper security, APIs can be vulnerable to attacks like DDoS or injection attacks
3. **Compliance**: Many regulations (GDPR, HIPAA, etc.) require strict API security measures
4. **Business Trust**: Secure APIs build trust with your partners and customers

## Kong Security Architecture

Kong's security model is based on a plugin architecture that allows you to add different security layers to your API gateway:

```mermaid
graph TD
    A[Client] -->|Request| B[Kong Gateway]
    B -->|Authentication| C{Auth Plugin}
    C -->|Success| D[Rate Limiting]
    C -->|Failure| E[Reject]
    D -->|Within limits| F[ACL Check]
    D -->|Exceeds limits| E
    F -->|Allowed| G[Backend API]
    F -->|Denied| E
```

## Essential Kong Security Plugins

Let's explore the key security plugins available in Kong:

### 1. Authentication Plugins

Kong offers several authentication plugins to verify the identity of API consumers:

#### Basic Authentication

The Basic Auth plugin implements HTTP Basic Authentication:

```bash
# Enable Basic Auth plugin on a route
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=basic-auth" \
  --data "config.hide_credentials=true"

# Create a consumer
curl -X POST http://localhost:8001/consumers \
  --data "username=johndoe"

# Create credentials for the consumer
curl -X POST http://localhost:8001/consumers/johndoe/basic-auth \
  --data "username=johndoe" \
  --data "password=secret"
```

When a client makes a request, they need to include the Authorization header:

```bash
# Client request with Basic Auth
curl -X GET https://api.example.com/resource \
  -H "Authorization: Basic am9obmRvZTpzZWNyZXQ="
```

#### Key Authentication

The Key Auth plugin is simpler and requires an API key:

```bash
# Enable Key Auth plugin
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=key-auth" \
  --data "config.key_names=apikey"

# Create a consumer
curl -X POST http://localhost:8001/consumers \
  --data "username=appclient"

# Create an API key for the consumer
curl -X POST http://localhost:8001/consumers/appclient/key-auth \
  --data "key=your-secret-api-key"
```

Clients then use the key in their requests:

```bash
# Client request with API key
curl -X GET https://api.example.com/resource?apikey=your-secret-api-key
```

#### JWT Authentication

For more advanced scenarios, Kong supports JSON Web Tokens:

```bash
# Enable JWT plugin
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=jwt"

# Create a consumer
curl -X POST http://localhost:8001/consumers \
  --data "username=mobileclient"

# Create a JWT credential (this returns a secret and key)
curl -X POST http://localhost:8001/consumers/mobileclient/jwt
```

Clients need to include the JWT token in the Authorization header:

```bash
# Client request with JWT
curl -X GET https://api.example.com/resource \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

### 2. Authorization Plugins

Once users are authenticated, you may want to control what they can access:

#### ACL (Access Control List)

The ACL plugin restricts access to your API to specific consumer groups:

```bash
# Enable ACL plugin
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=acl" \
  --data "config.allow=admin-group"

# Assign a consumer to a group
curl -X POST http://localhost:8001/consumers/johndoe/acls \
  --data "group=admin-group"
```

#### RBAC (Role-Based Access Control)

Enterprise Kong provides more advanced RBAC capabilities to define fine-grained permissions.

### 3. Traffic Control Plugins

Protecting your APIs also means managing traffic properly:

#### Rate Limiting

Prevent abuse by limiting how many requests clients can make:

```bash
# Enable rate limiting
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=rate-limiting" \
  --data "config.minute=100" \
  --data "config.hour=1000"
```

This configuration limits consumers to 100 requests per minute and 1000 per hour.

#### IP Restriction

Restrict API access to specific IP addresses:

```bash
# Allow only specific IPs
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=ip-restriction" \
  --data "config.allow=192.168.1.1,192.168.1.2"
```

### 4. Security Headers and SSL

Enhance security with proper headers and SSL configuration:

#### CORS Plugin

Control cross-origin resource sharing:

```bash
# Enable CORS
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=cors" \
  --data "config.origins=https://example.com" \
  --data "config.methods=GET,POST" \
  --data "config.headers=Content-Type,Authorization" \
  --data "config.exposed_headers=X-Auth-Token" \
  --data "config.max_age=3600" \
  --data "config.credentials=true"
```

#### SSL Plugin

Kong can handle SSL termination and enforce HTTPS:

```bash
# Create an SSL certificate
curl -X POST http://localhost:8001/certificates \
  --data "cert=$(cat your-cert.pem)" \
  --data "key=$(cat your-key.pem)" \
  --data "snis=api.example.com"
```

## Real-World Security Scenarios

Let's explore some practical scenarios where Kong security plugins shine:

### Scenario 1: Public and Private API Endpoints

Imagine you have an e-commerce application with both public and private endpoints:

1. **Public endpoints** (product listings, search): These need rate limiting but minimal authentication
2. **Private endpoints** (user profiles, orders): These require strong authentication and authorization

```mermaid
graph LR
    Client-->|Request| Kong
    Kong-->|Public Path| RateLimit[Rate Limiting]
    Kong-->|Private Path| Auth[JWT Auth]
    Auth-->ACL[ACL Check]
    RateLimit-->|/products/*| Backend
    ACL-->|Verified User| Backend
```

Configuration example:

```bash
# For public routes (e.g., /products)
curl -X POST http://localhost:8001/routes/product-route/plugins \
  --data "name=rate-limiting" \
  --data "config.minute=300"

# For private routes (e.g., /orders)
curl -X POST http://localhost:8001/routes/order-route/plugins \
  --data "name=jwt"

curl -X POST http://localhost:8001/routes/order-route/plugins \
  --data "name=acl" \
  --data "config.allow=customer-group"

curl -X POST http://localhost:8001/routes/order-route/plugins \
  --data "name=rate-limiting" \
  --data "config.minute=60"
```

### Scenario 2: Microservices Security

When securing a microservices architecture, you can implement:

1. **Service-to-service authentication** using mutual TLS
2. **Consumer-specific rate limiting** to prevent one service from overwhelming another
3. **Fine-grained access control** between microservices

```bash
# Enable mTLS between services
curl -X POST http://localhost:8001/routes/{route_id}/plugins \
  --data "name=mtls-auth"

# Configure consumer-specific rate limits
curl -X POST http://localhost:8001/plugins \
  --data "name=rate-limiting" \
  --data "consumer.id={consumer_id}" \
  --data "config.minute=1000"
```

## Best Practices for Kong Security

Here are some key best practices to follow when securing your Kong Gateway:

1. **Defense in Depth**: Implement multiple security layers (authentication, authorization, rate limiting)
2. **Least Privilege**: Grant minimum necessary access to each consumer
3. **Use Strong Authentication**: Prefer JWT or OAuth2 over simpler methods for sensitive APIs
4. **API Key Management**: Rotate API keys regularly and use secure distribution methods
5. **Monitor and Log**: Enable the HTTP Log plugin to track security events
6. **Secure Admin API**: Restrict access to Kong's Admin API to trusted networks
7. **Keep Kong Updated**: Regularly update Kong to get the latest security patches

Example of securing the Admin API:

```bash
# Restrict Admin API to localhost
kong start --admin_listen 127.0.0.1:8001
```

## Implementing a Complete Security Stack

A robust Kong security implementation typically includes:

1. **Authentication** (JWT, OAuth2, or Key Auth)
2. **Authorization** (ACL)
3. **Rate Limiting**
4. **IP Filtering**
5. **Request Size Limiting**
6. **Bot Detection**
7. **Security Headers**
8. **SSL/TLS**

Here's a common plugin execution order:

```mermaid
graph LR
    A[Request] --> B[CORS]
    B --> C[Bot Detection]
    C --> D[IP Restriction]
    D --> E[Authentication]
    E --> F[ACL]
    F --> G[Rate Limiting]
    G --> H[Request Transformer]
    H --> I[Backend Service]
```

## Troubleshooting Kong Security

When implementing security plugins, you might encounter these common issues:

1. **Authentication failures**: Check credentials and plugin configuration
2. **CORS issues**: Ensure origins, methods, and headers are properly configured
3. **Rate limiting problems**: Verify Redis configuration if using a distributed setup
4. **Plugin order conflicts**: Remember that plugin execution order matters

Debugging example:

```bash
# Get detailed logs
kong start --log-level debug

# Test a route with verbose output
curl -v https://api.example.com/resource
```

## Summary

Kong provides a powerful and flexible security framework through its plugin ecosystem. By implementing the right combination of authentication, authorization, and traffic control plugins, you can create a robust security layer for your APIs.

Remember that security is not a one-time setup but an ongoing process. Regularly review your security configurations, keep Kong updated, and monitor your APIs for potential threats.

## Additional Resources

- [Kong Security Plugins Documentation](https://docs.konghq.com/hub/?category=security)
- [Kong Enterprise Security Features](https://konghq.com/products/kong-gateway/kong-enterprise)
- [OWASP API Security Top 10](https://owasp.org/API-Security/editions/2023/en/0x00-header/)

## Exercises

1. Set up a Kong Gateway with Basic Authentication and test it using curl.
2. Implement a security stack with JWT authentication, ACL, and rate limiting for a sample API.
3. Create different security configurations for public vs. private endpoints in your API.
4. Configure Kong to enforce HTTPS and proper security headers for all your APIs.
5. Implement a monitoring solution to track security events in your Kong Gateway.