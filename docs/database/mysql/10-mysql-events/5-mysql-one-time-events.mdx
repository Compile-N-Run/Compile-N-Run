---
title: "MySQL One-time Events"
description: "Learn how to create, manage and utilize one-time events in MySQL to schedule tasks that execute just once at a specific date and time."

---

# MySQL One-time Events

In this tutorial, you'll learn how to create and manage one-time events in MySQL. These are special database objects that allow you to schedule tasks to run automatically at a specific date and time, executing exactly once.

## Introduction

MySQL events are tasks that run according to a schedule. While recurring events run repeatedly based on a defined interval, **one-time events** execute just once at a predetermined date and time. They're perfect for situations where you need to schedule a single operation to occur at a specific moment in the future.

Common use cases for one-time events include:

- Scheduling database maintenance during low-traffic periods
- Sending one-time notifications
- Processing data at a specific deadline
- Performing cleanup operations after a specific time period

## Prerequisites

Before you start working with MySQL events, make sure:

1. You have MySQL 5.1.6 or later installed
2. The event scheduler is enabled
3. You have the necessary privileges to create events

## Checking and Enabling the Event Scheduler

First, let's check if the event scheduler is active:

```sql
SHOW VARIABLES LIKE 'event_scheduler';
```

If it's OFF, you can enable it with:

```sql
SET GLOBAL event_scheduler = ON;
```

Or permanently enable it in your MySQL configuration file by adding:

```
event_scheduler=ON
```

## Creating a One-time Event

The basic syntax for creating a one-time event is:

```sql
CREATE EVENT event_name
ON SCHEDULE AT timestamp
DO
    event_body;
```

Let's break down the key components:

- `event_name`: A unique identifier for your event
- `ON SCHEDULE AT timestamp`: Specifies when the event should execute
- `event_body`: The SQL statements to be executed when the event runs

### Example 1: Basic One-time Event

Let's create a simple one-time event that inserts a record into a log table at a specific time:

```sql
-- First, create our log table
CREATE TABLE event_log (
    id INT AUTO_INCREMENT PRIMARY KEY,
    event_name VARCHAR(100),
    execution_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    message VARCHAR(255)
);

-- Create a one-time event that will run 5 minutes from now
CREATE EVENT log_one_time_event
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 5 MINUTE
DO
    INSERT INTO event_log (event_name, message)
    VALUES ('log_one_time_event', 'This is a one-time event that executed successfully');
```

In this example, we create an event that will run exactly once, 5 minutes after it's created. When it executes, it will insert a record into our `event_log` table.

### Example 2: Using Specific Date and Time

You can schedule events to run at an exact date and time:

```sql
CREATE EVENT end_of_year_cleanup
ON SCHEDULE AT '2023-12-31 23:59:59'
DO
    BEGIN
        -- Archive old records
        INSERT INTO orders_archive
        SELECT * FROM orders 
        WHERE order_date < '2023-01-01';
        
        -- Delete archived records from the main table
        DELETE FROM orders 
        WHERE order_date < '2023-01-01';
        
        -- Log the operation
        INSERT INTO event_log (event_name, message)
        VALUES ('end_of_year_cleanup', 'Annual cleanup completed successfully');
    END;
```

This event will run once at the end of 2023, archiving all orders from before 2023 and then removing them from the main orders table.

## Advanced Features for One-time Events

### Using Comments

You can add comments to better document your events:

```sql
CREATE EVENT data_migration_event
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
COMMENT 'Migrates user data to the new schema'
DO
    BEGIN
        -- Migration logic here
        UPDATE users SET status = 'migrated' WHERE status = 'pending';
        
        INSERT INTO event_log (event_name, message)
        VALUES ('data_migration_event', 'User data migration completed');
    END;
```

### Setting Event Status

You can create disabled events that you'll enable later:

```sql
CREATE EVENT disabled_maintenance_event
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 12 HOUR
ENABLE
DO
    -- Maintenance tasks here
    OPTIMIZE TABLE large_data_table;
```

Other status options include:
- `ENABLE`: The event is immediately ready to execute (default)
- `DISABLE`: The event is created but won't execute until enabled
- `DISABLE ON SLAVE`: The event won't execute on replica servers

### Event Privileges

To create or modify events, you need the `EVENT` privilege:

```sql
-- Grant event privileges to a user
GRANT EVENT ON database_name.* TO 'username'@'host';
```

## Managing One-time Events

### Viewing Existing Events

To see all events in the current database:

```sql
SHOW EVENTS;
```

For more detailed information:

```sql
SELECT * FROM information_schema.events;
```

### Altering Events

You can modify an existing event:

```sql
ALTER EVENT end_of_year_cleanup
ON SCHEDULE AT '2023-12-30 23:59:59' -- Changed from Dec 31
COMMENT 'Rescheduled to run one day earlier';
```

### Dropping Events

When you no longer need an event:

```sql
DROP EVENT IF EXISTS log_one_time_event;
```

## Real-world Applications

### Example 1: Database Maintenance Window

Suppose your application has a maintenance window scheduled:

```sql
CREATE EVENT db_maintenance_window
ON SCHEDULE AT '2023-11-15 02:00:00' -- 2 AM on Nov 15, 2023
DO
    BEGIN
        -- Optimize tables during low traffic
        OPTIMIZE TABLE customers;
        OPTIMIZE TABLE orders;
        OPTIMIZE TABLE products;
        
        -- Update statistics
        ANALYZE TABLE customers;
        ANALYZE TABLE orders;
        ANALYZE TABLE products;
        
        -- Log completion
        INSERT INTO admin_log (operation, details)
        VALUES ('maintenance', 'Scheduled database optimization completed');
    END;
```

### Example 2: Temporary Promotion Expiration

For an e-commerce site running a flash sale:

```sql
-- First, create a flash sale with discounted products
INSERT INTO promotions (name, discount_percent, active)
VALUES ('Flash Friday', 25, 1);

-- Set products on sale
UPDATE products 
SET on_sale = 1, discount_id = LAST_INSERT_ID()
WHERE category_id IN (5, 8, 12);

-- Create event to end the promotion automatically
CREATE EVENT end_flash_sale
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 24 HOUR
DO
    BEGIN
        -- End the sale by updating products
        UPDATE products 
        SET on_sale = 0, discount_id = NULL
        WHERE discount_id = 123; -- assuming 123 is the promotion ID
        
        -- Mark the promotion as inactive
        UPDATE promotions 
        SET active = 0 
        WHERE id = 123;
        
        -- Log the action
        INSERT INTO system_log (action, message)
        VALUES ('promotion_ended', 'Flash Friday promotion ended automatically');
    END;
```

### Example 3: User Account Expiration

For temporary user accounts:

```sql
-- Create a temporary user account
INSERT INTO users (username, password, is_temporary, created_at)
VALUES ('temp_user', 'hashedpassword', 1, NOW());

-- Schedule deletion after 48 hours
CREATE EVENT delete_temp_user
ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 48 HOUR
DO
    DELETE FROM users WHERE username = 'temp_user' AND is_temporary = 1;
```

## Best Practices for One-time Events

1. **Always use error handling**: Wrap your event code in BEGIN...END blocks with error handling to ensure your events fail gracefully.

2. **Log event executions**: Always log when your events run and what they do, especially for critical operations.

3. **Consider time zones**: Be aware that event schedules use the server's time zone by default.

4. **Plan for server restarts**: If a server is down when an event should execute, the event won't run when the server comes back online.

5. **Test with shorter timeframes**: When developing events, test with short intervals before scheduling them far in the future.

6. **Maintain event documentation**: Keep track of what events exist and when they're scheduled to run.

## Common Issues and Troubleshooting

### Events Not Running

If your events aren't executing:

1. Verify the event scheduler is running:
```sql
SHOW VARIABLES LIKE 'event_scheduler';
```

2. Check if the event exists and is enabled:
```sql
SELECT * FROM information_schema.events 
WHERE event_name = 'your_event_name';
```

3. Confirm you have proper permissions:
```sql
SHOW GRANTS;
```

### Event Already Exists Error

If you get an error that the event already exists:

```sql
DROP EVENT IF EXISTS event_name;
-- Then recreate it
CREATE EVENT event_name...
```

## Summary

One-time events in MySQL are powerful tools for scheduling tasks to execute at specific moments. They provide an elegant way to automate operations without relying on external scheduling systems. In this tutorial, you've learned:

- How to create one-time events that execute at a precise date and time
- Managing event status, comments, and privileges
- Viewing, altering, and dropping events
- Practical applications like maintenance windows, promotion expiration, and account management
- Best practices and common troubleshooting techniques

## Exercises

To reinforce your understanding, try these exercises:

1. Create a one-time event that archives records older than 1 year into an archive table, scheduled for midnight tomorrow.

2. Make an event that sends a welcome email (insert into a mail queue table) to new users 24 hours after they register.

3. Create a disabled one-time event, then write the SQL commands to enable it.

4. Design a database cleanup solution that uses a one-time event to remove temporary data at the end of each month.

## Additional Resources

- [MySQL Event Scheduler Documentation](https://dev.mysql.com/doc/refman/8.0/en/event-scheduler.html)
- [MySQL Stored Procedures](https://dev.mysql.com/doc/refman/8.0/en/stored-programs-defining.html)
- [MySQL Error Handling](https://dev.mysql.com/doc/refman/8.0/en/error-handling.html)

Happy scheduling!