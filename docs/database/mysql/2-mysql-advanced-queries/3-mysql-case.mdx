---
title: MySQL CASE Statement
description: Learn how to use the CASE statement in MySQL to implement conditional logic in your SQL queries. This guide covers simple and searched CASE expressions with practical examples.

---

# MySQL CASE Statement

When writing SQL queries, you'll often need to implement conditional logic to transform or filter your data. MySQL's `CASE` statement allows you to add if-else logic directly into your queries, making them more powerful and flexible. This versatile tool can be used in SELECT statements, WHERE clauses, and even in ORDER BY and GROUP BY operations.

## What is the CASE Statement?

The CASE statement in MySQL is a control flow structure that evaluates a set of conditions and returns a result when a condition is met. It operates similar to if-else or switch statements in programming languages, allowing you to perform conditional logic directly in your SQL queries.

MySQL supports two forms of the CASE statement:

1. **Simple CASE statement** - Compares an expression to a set of values
2. **Searched CASE statement** - Evaluates a set of Boolean expressions

## Simple CASE Statement Syntax

The simple CASE statement compares an expression against a series of values:

```sql
CASE expression
    WHEN value1 THEN result1
    WHEN value2 THEN result2
    ...
    WHEN valueN THEN resultN
    ELSE default_result
END
```

## Searched CASE Statement Syntax

The searched CASE statement evaluates a list of Boolean conditions:

```sql
CASE
    WHEN condition1 THEN result1
    WHEN condition2 THEN result2
    ...
    WHEN conditionN THEN resultN
    ELSE default_result
END
```

## Basic CASE Statement Examples

Let's start with a few simple examples to understand how the CASE statement works. For these examples, imagine we have an `employees` table with columns for `employee_id`, `first_name`, `last_name`, `department`, and `salary`.

### Simple CASE Example

```sql
SELECT 
    employee_id,
    first_name,
    last_name,
    CASE department
        WHEN 'Marketing' THEN 'Marketing Team'
        WHEN 'Engineering' THEN 'Tech Team'
        WHEN 'Finance' THEN 'Money Team'
        ELSE 'Other Department'
    END AS department_category
FROM 
    employees;
```

**Output:**
```
+-------------+------------+-----------+--------------------+
| employee_id | first_name | last_name | department_category|
+-------------+------------+-----------+--------------------+
| 1           | John       | Smith     | Tech Team          |
| 2           | Mary       | Johnson   | Marketing Team     |
| 3           | Robert     | Williams  | Money Team         |
| 4           | Patricia   | Brown     | Other Department   |
+-------------+------------+-----------+--------------------+
```

### Searched CASE Example

```sql
SELECT 
    employee_id,
    first_name,
    last_name,
    salary,
    CASE
        WHEN salary < 50000 THEN 'Entry Level'
        WHEN salary BETWEEN 50000 AND 100000 THEN 'Mid Level'
        WHEN salary > 100000 THEN 'Senior Level'
        ELSE 'Not Categorized'
    END AS salary_category
FROM 
    employees;
```

**Output:**
```
+-------------+------------+-----------+--------+----------------+
| employee_id | first_name | last_name | salary | salary_category|
+-------------+------------+-----------+--------+----------------+
| 1           | John       | Smith     | 75000  | Mid Level      |
| 2           | Mary       | Johnson   | 45000  | Entry Level    |
| 3           | Robert     | Williams  | 120000 | Senior Level   |
| 4           | Patricia   | Brown     | 85000  | Mid Level      |
+-------------+------------+-----------+--------+----------------+
```

## Practical Applications of CASE Statement

Now that we understand the basic syntax, let's explore some practical use cases for the CASE statement in MySQL.

### 1. Transforming Data for Reports

CASE statements can transform numerical data into meaningful categories for reporting.

```sql
SELECT 
    product_id,
    product_name,
    price,
    CASE
        WHEN price < 10 THEN 'Budget'
        WHEN price BETWEEN 10 AND 50 THEN 'Mid-range'
        WHEN price > 50 THEN 'Premium'
    END AS price_category
FROM 
    products;
```

### 2. Conditional Aggregation

CASE statements can be used with aggregate functions to compute conditional totals:

```sql
SELECT 
    department,
    COUNT(*) AS total_employees,
    SUM(CASE WHEN gender = 'M' THEN 1 ELSE 0 END) AS male_count,
    SUM(CASE WHEN gender = 'F' THEN 1 ELSE 0 END) AS female_count
FROM 
    employees
GROUP BY 
    department;
```

**Output:**
```
+------------+-----------------+------------+-------------+
| department | total_employees | male_count | female_count|
+------------+-----------------+------------+-------------+
| Engineering| 45              | 35         | 10          |
| Marketing  | 30              | 12         | 18          |
| Finance    | 25              | 15         | 10          |
| HR         | 15              | 5          | 10          |
+------------+-----------------+------------+-------------+
```

### 3. Dynamic Sorting

CASE statements can be used in ORDER BY clauses to implement custom sorting logic:

```sql
SELECT 
    product_id,
    product_name,
    category
FROM 
    products
ORDER BY 
    CASE category
        WHEN 'Electronics' THEN 1
        WHEN 'Clothing' THEN 2
        WHEN 'Books' THEN 3
        ELSE 4
    END;
```

This query will display products with Electronics first, then Clothing, then Books, and finally all other categories.

### 4. Conditional Updates

CASE can be used in UPDATE statements to apply different updates based on conditions:

```sql
UPDATE salaries
SET annual_bonus = 
    CASE 
        WHEN performance_rating = 5 THEN base_salary * 0.15
        WHEN performance_rating = 4 THEN base_salary * 0.1
        WHEN performance_rating = 3 THEN base_salary * 0.05
        ELSE 0
    END;
```

## Advanced CASE Statement Examples

Let's explore some more advanced applications of the CASE statement:

### Nested CASE Statements

You can nest CASE statements for more complex conditional logic:

```sql
SELECT 
    order_id,
    total_amount,
    CASE
        WHEN total_amount > 1000 THEN 
            CASE 
                WHEN customer_type = 'Premium' THEN 'Large Premium Order'
                ELSE 'Large Regular Order'
            END
        WHEN total_amount > 500 THEN 'Medium Order'
        ELSE 'Small Order'
    END AS order_category
FROM 
    orders;
```

### Using CASE with Mathematical Operations

CASE statements can be included in mathematical operations:

```sql
SELECT 
    product_id,
    product_name,
    price,
    CASE
        WHEN category = 'Electronics' THEN price * 0.9  -- 10% discount
        WHEN category = 'Clothing' THEN price * 0.85    -- 15% discount
        ELSE price                                      -- No discount
    END AS discounted_price
FROM 
    products;
```

### CASE in HAVING Clause

You can use CASE in a HAVING clause to filter groups based on complex conditions:

```sql
SELECT 
    department,
    AVG(salary) AS avg_salary
FROM 
    employees
GROUP BY 
    department
HAVING 
    SUM(CASE WHEN performance_rating >= 4 THEN 1 ELSE 0 END) / COUNT(*) > 0.5;
```

This query returns departments where more than 50% of employees have a performance rating of 4 or higher.

## Best Practices for Using CASE Statements

When using CASE statements in MySQL, consider these best practices:

1. **Always include an ELSE clause**: This ensures your query handles all possible scenarios and prevents unexpected NULL values.

2. **Keep CASE expressions readable**: For complex logic, consider breaking down your query or using views to improve readability.

3. **Be mindful of performance**: Complex CASE statements, especially in large datasets, can impact query performance.

4. **Use consistent data types**: Ensure all possible return values from a CASE statement have the same or compatible data types.

5. **Consider NULL values**: Remember that NULL values in comparisons often yield unexpected results. Use IS NULL and IS NOT NULL where appropriate.

## When to Use CASE vs Other MySQL Constructs

While CASE statements are powerful, they're not always the best choice:

- For simple binary conditions, the IF() function might be cleaner: `IF(condition, true_value, false_value)`
- For NULL handling, consider IFNULL() or COALESCE(): `IFNULL(potentially_null_expression, replacement_value)`
- For complex data transformations, consider creating views or stored procedures

```sql
-- Using IF instead of CASE for simple conditions
SELECT 
    product_name,
    IF(stock_quantity > 0, 'In Stock', 'Out of Stock') AS availability
FROM 
    products;
```

## Summary

The MySQL CASE statement is a versatile tool for implementing conditional logic in your SQL queries. Whether you're transforming data for reports, performing conditional aggregation, implementing dynamic sorting, or creating complex business rules, CASE statements allow you to express sophisticated logic directly in your SQL.

We've covered:
- Basic syntax for Simple and Searched CASE statements
- Practical examples showing how to use CASE in various contexts
- Advanced applications including nested CASE statements
- Best practices for using CASE effectively

By mastering the CASE statement, you'll be able to create more powerful and flexible SQL queries that can handle complex business requirements directly in your database layer.

## Practice Exercises

1. Write a query that categorizes customers by their total spending: 'Bronze' for < $1000, 'Silver' for $1000-$5000, 'Gold' for > $5000.

2. Create a query that shows the count of orders by status, with columns for 'Pending', 'Shipped', 'Delivered', and 'Cancelled'.

3. Write an update statement that applies different discounts based on product category and quantity in stock.

4. Create a query that ranks employees in each department as 'Top Performer', 'Average', or 'Needs Improvement' based on their performance ratings.

5. Write a query that calculates different shipping charges based on order weight, destination, and shipping method.

## Additional Resources

- [MySQL Documentation on Flow Control Functions](https://dev.mysql.com/doc/refman/8.0/en/flow-control-functions.html)
- [MySQL CASE Statement Tutorial](https://www.mysqltutorial.org/mysql-case-function/)
- [SQL CASE Expression in W3Schools](https://www.w3schools.com/sql/sql_case.asp)